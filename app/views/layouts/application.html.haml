!!!5
%html
  %head
    / Global site tag (gtag.js) - Google Analytics
    %script{:async => "", :src => "https://www.googletagmanager.com/gtag/js?id=UA-115015564-1"}
    :javascript
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-115015564-1');

    // Hotjar
    :javascript
      (function(h,o,t,j,a,r){
          h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
          h._hjSettings={hjid:1940300,hjsv:6};
          a=o.getElementsByTagName('head')[0];
          r=o.createElement('script');r.async=1;
          r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
          a.appendChild(r);
      })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');

    -# = preload_link_tag 'i18n'
    = preload_link_tag(asset_pack_path("application.js"))
    -# = preload_link_tag 'bootstrap'
    -# = preload_link_tag 'application'


    %link{:href => "/favicon.ico", :rel => "apple-touch-icon", :sizes => "180x180"}/
    %link{:href => "/favicon.ico", :rel => "icon", :sizes => "32x32", :type => "image/png"}/
    %link{:href => "/favicon.ico", :rel => "icon", :sizes => "16x16", :type => "image/png"}/    
    %meta{:content => "#ffffff", :name => "msapplication-TileColor"}/
    %meta{:content => "/favicon.ico", :name => "msapplication-TileImage"}/
    %meta{:content => "#ffffff", :name => "theme-color"}/
    %meta{content: 'text/html; charset=UTF-8', 'http-equiv': 'Content-Type'}
    %meta{name: "viewport", content: "width=device-width, initial-scale=1"}
    %meta{content: 'text/html; charset=UTF-8', 'http-equiv': 'Content-Type'}
    %meta{name: "viewport", content: "width=device-width, initial-scale=1"}
    / Search console
    %meta{:content => "AkLEzizvTKMrUpFnhvKJ5dUMfOHfcjgsBxMXauTqBXg", :name => "google-site-verification"}/
    %title=meta_title
    %meta{:content => meta_description, :name => "description"}/
    %meta{:content => '/manifest.json', :name => "manifest"}/
    %base{href: '/marketplace'}


    %meta{:content => meta_title, :property => "og:title"}/
    %meta{:content => "website", :property => "og:type"}/
    %meta{:content => request.original_url, :property => "og:url"}/
    %meta{:content => meta_image, :property => "og:image"}/
    %meta{:content => meta_description, :property => "og:description"}/
    %meta{:content => meta_title, :property => "og:site_name"}/
    %meta{:content => meta_fb_locale, :property => "og:locale"}/
    - meta_fb_locales.each do |l|
      %meta{:content => l, :property => "og:locale:alternate"}/
    %meta{:content => Rails.application.secrets[:facebook][:key], :name => "fb:app_id"}/


    = Gon::Base.render_data
    = csrf_meta_tags
    = action_cable_meta_tag
    - if Rails.env.development?
      %script{:src => "https://cdnjs.cloudflare.com/ajax/libs/markerclustererplus/2.1.4/markerclusterer.js"}
      %script{:async => "", :defer => "defer", :src => "https://www.google.com/recaptcha/api.js?onload=vueRecaptchaApiLoaded&render=explicit"}
      = stylesheet_link_tag 'bootstrap', media: 'all'
      = stylesheet_pack_tag 'application', media: 'all'
      = javascript_include_tag 'i18n', skip_pipeline: true
      = javascript_include_tag 'translations.js?v2323232', skip_pipeline: true
      = javascript_pack_tag 'application'
    - unless is_lighthouse
      / Facebook Pixel Code
      :javascript
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window, document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
        fbq('init', '742711365932762');
        fbq('init', '189782348452598');
        fbq('track', 'PageView');
      / Google Tag Manager
      :javascript
        (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-W4PPCSJ');
      / End Google Tag Manager

      :javascript
        gtag('event', 'conversion', {'send_to': 'AW-816475260/HWJWCO7LzbgBEPzYqYUD'});

      / Cookie bot
      / Global site tag (gtag.js) - Google Ads: 816475260
      %script{:async => "", :src => "https://www.googletagmanager.com/gtag/js?id=AW-816475260"}
      / Start of HubSpot Embed Code
      %script#hs-script-loader{:async => "", :defer => "defer", :src => "//js.hs-scripts.com/6671711.js"}
      / End of HubSpot Embed Code
      /Mailchimp general code  to enable pop-up forms and Google remarketing ads.
      -# %script#mcjs
      -#   \!function(c,h,i,m,p){m=c.createElement(h),p=c.getElementsByTagName(h)[0],m.async=1,m.src=i,p.parentNode.insertBefore(m,p)}(document,"script","https://chimpstatic.com/mcjs-connected/js/users/2f0c64d332f18eea892b395f9/8fd8545e68d5393478351ccba.js");
      :javascript
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'AW-816475260');

        function clickLogin(ev, type){
          type = type || false
          if(!window.authApp.user.user_name){
            ev.preventDefault();
            if(type){
              fbq('track', type);
            }
            else {
              fbq('track', 'GetStarted');
            }
            window.authApp.showLogin()
          }
        }


    - if flash[:event]
      :javascript
        fbq('track', '#{flash[:event]}');
        dataLayer.push ({ 'event': '#{flash[:g_event]}' })
    %noscript
      %img{:height => "1", :src => "https://www.facebook.com/tr?id=742711365932762&ev=PageView&noscript=1", :style => "display:none", :width => "1"}/
      %img{:height => "1", :src => "https://www.facebook.com/tr?id=189782348452598&ev=PageView&noscript=1", :style => "display:none", :width => "1"}/

    / End Facebook Pixel Code
    :javascript
      document.oncopy = function () { 
        var bodyElement = document.body; 
        var selection = getSelection(); 
        var href = document.location.href; 
        var copyright = "<br><br>See more at: <a href='"+ href +"'>" + href + "</a><br>Â© Global Supplies "; 
        var text = selection + copyright; 
        var divElement = document.createElement('div'); 
        divElement.style.position = 'absolute'; 
        divElement.style.left = '-99999px'; 
        divElement.innerHTML = text; 
        bodyElement.appendChild(divElement); 
        selection.selectAllChildren(divElement); 
        setTimeout(function() { 
          bodyElement.removeChild(divElement);
        }, 0);
      };
    :javascript
      window.token = '#{flash[:reset_token].to_s}'
      window.showRestore = '#{flash[:show_restore].presence}'
      window.showChangePwd = '#{flash[:show_change_pwd].presence}'
      window.RestoreAction = '#{flash[:restore_action].to_s}'
  %body
    - if is_lighthouse
      %app-header{id: "app-header"}
      %app-footer{id: "app-footer"}
    - else 
      %app#app{"v-cloak"=>true}
    / Chat bot
    - if Rails.env.production?
      - if is_lighthouse
        = javascript_include_tag 'i18n'
        = javascript_include_tag 'translations.js?v2323232', skip_pipeline: true
        = javascript_pack_tag 'landing'
      - else
        %script#hs-script-loader{:async => "", :defer => "defer", :src => "//js.hs-scripts.com/6671711.js"}     


        %script{:src => "https://cdnjs.cloudflare.com/ajax/libs/markerclustererplus/2.1.4/markerclusterer.js"}
        %script{:async => "", :defer => "defer", :src => "https://www.google.com/recaptcha/api.js?onload=vueRecaptchaApiLoaded&render=explicit"}
        = javascript_include_tag 'i18n', skip_pipeline: true
        = javascript_include_tag 'translations.js?v2323232', skip_pipeline: true
        = javascript_pack_tag 'application'
      = stylesheet_link_tag 'bootstrap', media: 'all'
      - if is_lighthouse
        = stylesheet_pack_tag 'landing', media: 'all'
      - else
        = stylesheet_pack_tag 'application', media: 'all'


